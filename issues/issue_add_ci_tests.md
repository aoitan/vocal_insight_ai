# issue_add_ci_tests: 自動テスト (CI) の組み込み

## 1. 背景

現在、プロジェクトにはローカルでの `pre-commit` フックが導入されていますが、プッシュされた変更に対する包括的な自動テストは実施されていません。これにより、環境依存のバグや、複数の変更がマージされた際の予期せぬ問題が見過ごされるリスクがあります。

## 2. 目的

GitHub Actions を利用してCIパイプラインを構築し、プッシュされたすべての変更に対して自動テストを実行することで、以下の目的を達成します。

*   コード品質の向上と維持
*   バグの早期発見と修正
*   開発プロセスの効率化と信頼性の向上
*   チームメンバーが安心してコードをマージできる環境の構築

## 3. タスクリスト

### 3.1. CI設定ファイルの作成

*   `.github/workflows/ci.yml` ファイルを作成する。
*   Python環境のセットアップ (Poetryのインストールと依存関係の解決) を定義する。
*   以下のテストステップを組み込む:
    *   `poetry run pytest` を実行し、すべてのユニットテストを実行する。
    *   `poetry run ruff check .` を実行し、コードのリンティングを行う。
    *   (もし導入されていれば) `poetry run mypy .` を実行し、型チェックを行う。

### 3.2. テストスクリプトの確認・調整

*   既存の `pytest` テストがCI環境で正しく実行されることを確認する。
*   `ruff` の設定がCI環境とローカル環境で一貫していることを確認する。
*   (もし `mypy` を導入する場合) `mypy` の設定と実行方法を確認する。

### 3.3. プルリクエストとの連携

*   CIがプルリクエストのステータスチェックとして機能するように設定する。
*   テスト失敗時にプルリクエストのマージがブロックされるように設定する。

## 4. 考慮事項

*   **Pythonバージョンの指定:** CIでテストするPythonバージョンを明確にする (例: 3.9, 3.10, 3.11)。
*   **依存関係のキャッシュ:** `poetry install` の実行時間を短縮するため、Poetryのキャッシュを活用する。
*   **通知設定:** テスト失敗時に適切な通知が送られるように設定する。
*   **テストカバレッジ:** 将来的にはテストカバレッジの計測とレポート生成も検討する。

## 5. 完了基準

*   `.github/workflows/ci.yml` が作成され、GitHub Actions で自動テストが実行されること。
*   すべてのユニットテスト、リンティング、型チェック (もしあれば) がCIで成功すること。
*   プルリクエスト作成時にCIが自動的に実行され、結果がGitHub上で確認できること。
*   テスト失敗時にプルリクエストのマージがブロックされること。
