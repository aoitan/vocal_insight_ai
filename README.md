# VocalInsight AI

Praatの音響分析機能とLLM（大規模言語モデル）を組み合わせ、歌声のパフォーマンスを分析するためのプロンプトを自動生成するPythonスクリプトです。

このツールは、音声ファイルからボーカルのダイナミクスに基づきセグメントを自動分割し、各セグメントの音響特徴（ピッチ、HNR、フォルマント等）を抽出。最終的に、LLMが解釈しやすい自然言語形式のプロンプトを生成します。

## ✨ 主な機能

- **動的セグメント分割:** 音声全体のRMS（音量）エネルギーの変化点を検出し、楽曲の展開に応じて自動で区間を分割します。
- **詳細な音響分析:** `praat-parselmouth` を利用し、各セグメントの平均ピッチ(F0)、ピッチの揺らぎ(F0 StdDev)、HNR（声のクリアさ）、フォルマント(F1-F3)を分析します。
- **頑健なデータ処理:** 短すぎる/長すぎるセグメントの自動調整や、無音区間を考慮したHNR計算など、分析の精度を高めるための処理を実装。
- **LLM向けプロンプト生成:** 分析結果を、LLMがボーカルアナリストとして振る舞うための詳細な指示付きプロンプトとして出力します。

## ⚙️ 動作環境とインストール

[MiniConda](https://docs.conda.io/en/latest/miniconda.html)がインストールされている例です。

1.  **Conda仮想環境の作成**
    ```bash
    conda create -n voice-llm python=3.10 -y
    conda activate voice-llm
    ```

2.  **依存ライブラリのインストール**
    ```bash
    pip install librosa praat-parselmouth soundfile numpy
    ```

## 🚀 使い方

スクリプトをターミナル（コマンドプロンプトやPowerShell）から実行します。

```bash
python vocal_insight_ai.py "path/to/your/song.wav"
```

実行後、音声ファイルと同じディレクトリに `<入力ファイル名>_prompt.txt` という名前で分析結果のプロンプトが出力されます。

## 📋 出力サンプル

`<入力ファイル名>_prompt.txt` には以下のようなテキストが出力されます。これをコピーして、お好きなLLMに貼り付けてください。

```text
あなたはプロのボーカルアナリストです。
以下のデータは、楽曲「your_song.wav」の歌声の時系列データから、ダイナミクスの変化で分割したセグメントごとの音響特徴です。
このデータを元に、以下の点を総合的に分析し、レポートを作成してください。
- 感情の推移: ...
- 歌唱技術: ...
- セグメント間の比較: ...
---
### 分析データ

--- Segment 1 (0.00s - 8.52s) ---
- 平均ピッチ (F0): 250.1 Hz
- ピッチの揺らぎ (F0 StdDev): 35.2 Hz
- 声のクリアさ (HNR): 15.3 dB
...
```

## 🛠 今後の拡張案

* `matplotlib` を使ったピッチやRMSの推移グラフの可視化
* 裏声・地声の自動判定機能の追加
* `Streamlit` などを使ったWeb UI化

## ©️ ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。